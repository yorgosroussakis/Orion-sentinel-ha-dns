# Orion Sentinel - Suricata-Update Configuration
# Copy to: /mnt/orion-nvme-netsec/suricata/etc/update.yaml
#
# This file configures suricata-update for rule management.

# Output directory for rules
output: /var/lib/suricata/rules

# Disable configuration file location
disable-conf: /etc/suricata/disable.conf

# Enable configuration file location (for enabling specific rules)
# enable-conf: /etc/suricata/enable.conf

# Modify configuration file location (for modifying rule actions)
# modify-conf: /etc/suricata/modify.conf

# Drop configuration file location (for converting rules to drop)
# drop-conf: /etc/suricata/drop.conf

# Rule sources
sources:
  # Emerging Threats Open rules (free)
  - https://rules.emergingthreats.net/open/suricata-%(__version__)s/emerging.rules.tar.gz

# Alternative sources (uncomment as needed):
# - https://rules.emergingthreats.net/OPEN/suricata-5.0/emerging.rules.tar.gz

# Local rule files to include
# local:
#   - /etc/suricata/rules/local.rules

# Files to ignore from rule sources
ignore:
  - "*deleted*"

# Testing mode - validates rules but doesn't deploy
test-command: suricata -T -c /etc/suricata/suricata.yaml --set "classification-file=/var/lib/suricata/rules/classification.config"

# Reload command after rule update (commented out - use docker restart)
# reload-command: suricatasc -c reload-rules
