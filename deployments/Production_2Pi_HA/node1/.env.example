# =============================================================================
# Production-Ready 2-Pi DNS HA Configuration - Node 1 (PRIMARY)
# =============================================================================
#
# Copy this file to .env and customize for your environment:
#   cp .env.example .env
#   nano .env
#
# IMPORTANT: Generate secure passwords before deployment!
#   openssl rand -base64 32
#
# =============================================================================

# =============================================================================
# Node Identity
# =============================================================================
NODE_ROLE=primary
NODE_IP=192.168.8.11
PEER_IP=192.168.8.12

# =============================================================================
# Network Configuration
# =============================================================================
NETWORK_INTERFACE=eth0
SUBNET=192.168.8.0/24
GATEWAY=192.168.8.1
IP_RANGE=192.168.8.240/28

# =============================================================================
# Virtual IP (VIP) Configuration
# =============================================================================
# This IP floats between nodes based on health and priority
VIP_ADDRESS=192.168.8.255

# =============================================================================
# Service IP Addresses
# =============================================================================
PIHOLE_PRIMARY_IP=192.168.8.251
PIHOLE_SECONDARY_IP=192.168.8.252
UNBOUND_PRIMARY_IP=192.168.8.253
UNBOUND_SECONDARY_IP=192.168.8.254

# =============================================================================
# Timezone
# =============================================================================
TZ=Europe/London

# =============================================================================
# Pi-hole Configuration
# =============================================================================
# REQUIRED: Set a strong password! (Generate with: openssl rand -base64 32)
PIHOLE_PASSWORD=CHANGE_THIS_TO_A_SECURE_PASSWORD

# Optional: Pi-hole theme (default-dark, default-light, etc.)
PIHOLE_THEME=default-dark

# =============================================================================
# Keepalived / VRRP Configuration
# =============================================================================
# Priority: Higher value = more likely to be MASTER
# Primary: 100, Secondary: 90
KEEPALIVED_PRIORITY=100

# Virtual Router ID (must be same on both nodes, 1-255)
VIRTUAL_ROUTER_ID=51

# REQUIRED: VRRP authentication password (must match on both nodes!)
# Generate with: openssl rand -base64 20
VRRP_PASSWORD=CHANGE_THIS_VRRP_PASSWORD

# =============================================================================
# Notification Settings
# =============================================================================
# Enable/disable notifications on state changes
NOTIFY_ON_FAILOVER=true
NOTIFY_ON_FAILBACK=true

# Optional: Webhook URL for alerts (e.g., Slack, Discord, custom endpoint)
ALERT_WEBHOOK=

# Optional: Signal notifications
SIGNAL_API_URL=
SIGNAL_NUMBER=
SIGNAL_RECIPIENTS=

# Optional: Prometheus Pushgateway
PROMETHEUS_PUSHGATEWAY=

# =============================================================================
# Automation Configuration
# =============================================================================
# Pi-hole sync interval in seconds (default: 5 minutes)
SYNC_INTERVAL=300

# What to sync to secondary node
SYNC_GRAVITY=true
SYNC_CUSTOM=true
SYNC_WHITELIST=true
SYNC_BLACKLIST=true

# Backup interval in seconds (default: 24 hours)
BACKUP_INTERVAL=86400

# Backup retention in days
RETENTION_DAYS=30

# =============================================================================
# Health Monitoring
# =============================================================================
# Health check interval in seconds
HEALTH_CHECK_INTERVAL=60

# Maximum restart attempts before giving up
MAX_RESTART_ATTEMPTS=3

# Cooldown between restarts in seconds
RESTART_COOLDOWN=300

# Domain for DNS health checks
TEST_DOMAIN=google.com

# Resource thresholds for alerts
DISK_USAGE_THRESHOLD=85
MEMORY_USAGE_THRESHOLD=90
LOG_MAX_SIZE_MB=100
