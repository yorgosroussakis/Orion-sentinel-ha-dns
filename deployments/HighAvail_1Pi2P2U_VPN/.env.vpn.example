# ===================================================================
# WireGuard VPN Front Door Configuration
# ===================================================================
# This adds WireGuard VPN access to your HA DNS stack.
# VPN clients will use your HA VIP (192.168.8.255) for DNS.
#
# Quick Setup:
# 1. Set WG_HOST to your public IP or DDNS hostname
# 2. Forward port 51820/UDP on your router to this Pi
# 3. Adjust WG_PEERS as needed
# 4. Deploy: docker compose up -d
# ===================================================================

# --- General Settings ---
TZ=Europe/Amsterdam
PUID=1000
PGID=1000

# --- WireGuard Server Public Endpoint ---
# REQUIRED: Your public IP or DDNS hostname
# Examples: 
#   - Public IP: 203.0.113.45
#   - DDNS: myhome.duckdns.org
#   - Domain: vpn.mydomain.com
WG_HOST=myhome.ddns.net

# UDP port WireGuard listens on (also forward this on your router)
# Default: 51820
WG_PORT=51820

# --- Peer (Client) Configuration ---
# Number of peers to auto-generate, or comma-separated list of names
# Examples:
#   - "3" → generates peer_1, peer_2, peer_3
#   - "phone,laptop,tablet" → generates named peers with QR codes
WG_PEERS=phone,laptop,tablet

# Internal VPN tunnel subnet
# Default: 10.6.0.0/24 (won't conflict with LAN 192.168.8.0/24)
WG_SUBNET=10.6.0.0/24

# --- DNS Configuration (Integration with HA Stack) ---
# DNS server for VPN clients → your HA VIP for automatic failover
# This is the KEY integration point!
WG_PEER_DNS=192.168.8.255

# --- AllowedIPs (Routing Configuration) ---
# What traffic goes through the VPN?
# 
# Option 1: Split tunnel (RECOMMENDED) - Only DNS + LAN traffic
#   WG_ALLOWEDIPS=192.168.8.0/24,10.6.0.0/24
#   Benefits: Better performance, lower battery drain
#   Use case: Access home services + ad-blocking DNS
#
# Option 2: Full tunnel - All traffic through VPN
#   WG_ALLOWEDIPS=0.0.0.0/0
#   Benefits: Complete privacy, all traffic encrypted
#   Use case: Public WiFi, want everything through home
WG_ALLOWEDIPS=192.168.8.0/24,10.6.0.0/24

# --- Storage ---
# Where to store WireGuard configs and peer QR code images
WG_CONFIG_DIR=./wireguard/config

# --- WireGuard-UI Configuration (Web Management) ---
# Enable web UI for managing peers with QR codes
ENABLE_WGUI=true
WGUI_USERNAME=admin
WGUI_PASSWORD=ChangeThisSecurePassword123!
WGUI_SESSION_SECRET=ChangeThisRandomSessionSecret456!

# WireGuard-UI port (internal, access via http://192.168.8.250:5000)
WGUI_PORT=5000

# --- Advanced Settings (Usually don't need to change) ---
# MTU for WireGuard interface
WG_MTU=1420

# Persistent keepalive (helps with NAT traversal)
WG_PERSISTENT_KEEPALIVE=25

# Log level: DEBUG, INFO, WARN, ERROR
WG_LOG_LEVEL=INFO

# ===================================================================
# Post-Setup Steps:
# ===================================================================
# 1. Deploy: docker compose up -d
# 2. Check logs: docker logs wireguard
# 3. Access WireGuard-UI: http://192.168.8.250:5000
# 4. View QR codes in the UI or at: ./wireguard/config/peer_*/peer_*.png
# 5. Scan QR with WireGuard mobile app
# 6. Test: ping 192.168.8.255 (should work!)
# ===================================================================
