{
  "description": "Nginx Proxy Manager configuration for exposing Jellyfin media server",
  "instructions": "Import this in NPM or manually create the proxy host",
  
  "proxy_host": {
    "domain_names": ["jellyfin.home.local"],
    "forward_scheme": "http",
    "forward_host": "192.168.8.100",
    "forward_port": 8096,
    "certificate_id": 0,
    "ssl_forced": false,
    "caching_enabled": true,
    "block_exploits": true,
    "allow_websocket_upgrade": true,
    "http2_support": true,
    "hsts_enabled": false,
    "hsts_subdomains": false,
    
    "access_list_id": 0,
    
    "advanced_config": "# Jellyfin-specific settings\nclient_max_body_size 0;\nproxy_buffering off;\n\n# Disable buffering when the nginx proxy gets very resource heavy upon streaming\nproxy_buffering off;\n\n# Proxy headers\nproxy_set_header Host $host;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forwarded-Proto $scheme;\nproxy_set_header X-Forwarded-Protocol $scheme;\nproxy_set_header X-Forwarded-Host $http_host;\n\n# Websockets\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection $http_connection;"
  },
  
  "manual_setup_steps": [
    "1. Log into Nginx Proxy Manager at http://192.168.8.250:81",
    "2. Go to 'Proxy Hosts' and click 'Add Proxy Host'",
    "3. In the 'Details' tab:",
    "   - Domain Names: jellyfin.home.local",
    "   - Scheme: http",
    "   - Forward Hostname/IP: 192.168.8.100",
    "   - Forward Port: 8096",
    "   - Cache Assets: ON",
    "   - Block Common Exploits: ON",
    "   - Websockets Support: ON",
    "4. In the 'Advanced' tab, paste the advanced config above",
    "5. Click 'Save'",
    "6. Connect to VPN and access: http://jellyfin.home.local"
  ],
  
  "other_media_servers": {
    "plex": {
      "forward_host": "192.168.8.101",
      "forward_port": 32400,
      "domain": "plex.home.local",
      "notes": "Plex requires special configuration. See: https://support.plex.tv/articles/200430283-network/"
    },
    "emby": {
      "forward_host": "192.168.8.102",
      "forward_port": 8096,
      "domain": "emby.home.local",
      "notes": "Emby uses same port as Jellyfin (8096)"
    },
    "tautulli": {
      "forward_host": "192.168.8.103",
      "forward_port": 8181,
      "domain": "tautulli.home.local",
      "notes": "Plex statistics and monitoring"
    }
  },
  
  "testing": {
    "steps": [
      "1. Connect to WireGuard VPN",
      "2. Open browser and navigate to http://jellyfin.home.local",
      "3. You should see Jellyfin login page",
      "4. Log in with your Jellyfin credentials",
      "5. Test streaming a video"
    ]
  },
  
  "ssl_configuration": {
    "note": "For .local domains, SSL is not typically used. If you have a real domain:",
    "steps": [
      "1. In NPM, go to 'SSL Certificates'",
      "2. Click 'Add SSL Certificate' â†’ 'Let's Encrypt'",
      "3. Enter your real domain (e.g., jellyfin.yourdomain.com)",
      "4. Enter email address",
      "5. Agree to Terms of Service",
      "6. Click 'Save'",
      "7. Edit your proxy host and select the new certificate",
      "8. Enable 'Force SSL'"
    ]
  },
  
  "troubleshooting": {
    "cannot_access": [
      "- Ensure you're connected to VPN",
      "- Verify Jellyfin is running: http://192.168.8.100:8096",
      "- Check NPM logs: docker logs nginx-proxy-manager",
      "- Verify proxy host is enabled in NPM"
    ],
    "streaming_issues": [
      "- Check advanced config includes proxy_buffering off",
      "- Ensure websockets support is enabled",
      "- Lower video quality in Jellyfin if bandwidth limited",
      "- Check VPN MTU setting (try 1380 or 1280)"
    ],
    "ssl_errors": [
      "- Ensure DNS resolves to your public IP",
      "- Port 80 and 443 must be forwarded to Pi",
      "- Let's Encrypt has rate limits, wait if hit limit"
    ]
  }
}
