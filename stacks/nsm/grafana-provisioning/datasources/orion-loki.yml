apiVersion: 1

datasources:
  # Loki datasource for Orion Sentinel security logs
  - name: Loki
    type: loki
    access: proxy
    # Use environment variable or Docker internal URL
    url: ${LOKI_URL:-http://loki:3100}
    isDefault: false
    editable: true
    jsonData:
      # Maximum number of lines to fetch per query
      maxLines: 5000
      # Timeout for queries (in seconds)
      timeout: 60
      # Derived fields for better log exploration
      derivedFields:
        - name: TraceID
          matcherRegex: "trace_id=(\\w+)"
          url: "$${__value.raw}"
